# Examples

> [!TIP]
> Try out `unidep` in this folder by running:
> - `unidep install ./setup_py_project ./hatch_project` to install the `setup_py_project` and `hatch_project` packages with `conda` and the rest of the dependencies with `pip`
> - `unidep install-all -e` to install all packages (`setup_py_project`, `hatch_project`, and `setuptools_project`) in editable mode
> - `unidep conda-lock` to generate a global `conda-lock.yml` file and consistent per package `conda-lock.yml` files
> - `unidep merge` to merge all `requirements.yaml` files into a single `environment.yaml` file
> - `unidep pip-compile` to generate a locked `requirements.txt` file

Check the installable Python packages in this directory for examples of how to use `unidep` with different project types:

- [`setup_py_project` for a `setup.py` integration example](setup_py_project/)
- [`pyproject_toml_project` for a `pyproject.toml` with Setuptools example](pyproject_toml_project/)
- [`hatch_project` for Hatchling project example](hatch_project)

## A few examples of `unidep` in action

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [Combine one or multiple `requirements.yaml` files into a single `environment.yaml` file](#combine-one-or-multiple-requirementsyaml-files-into-a-single-environmentyaml-file)
- [Install a package using `requirements.yaml` file directly with `pip`](#install-a-package-using-requirementsyaml-file-directly-with-pip)
- [Install a `requirements.yaml` file directly with `unidep`](#install-a-requirementsyaml-file-directly-with-unidep)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

### Combine one or multiple `requirements.yaml` files into a single `environment.yaml` file

Combine `requirements.yaml` files in subdirectories and into an `environment.yaml` file that can be installed with `conda`.

Here we can just run `unidep merge` with no arguments, since the defaults are the same as what we want.

This would be the same as running `unidep merge --name myenv --verbose`:

<!-- CODE:BASH:START -->
<!-- echo '```bash' -->
<!-- unidep merge --name myenv --verbose -->
<!-- echo '```' -->
<!-- CODE:END -->
<!-- OUTPUT:START -->
<!-- ⚠️ This content is auto-generated by `markdown-code-runner`. -->
```bash
🔍 Scanning in `.` at depth 0
🔍 Scanning in `setup_py_project` at depth 1
🔍 Found `requirements.yaml` at `setup_py_project/requirements.yaml`
🔍 Scanning in `setuptools_project` at depth 1
🔍 Found `requirements.yaml` at `setuptools_project/requirements.yaml`
🔍 Scanning in `hatch_project` at depth 1
🔍 Found `requirements.yaml` at `hatch_project/requirements.yaml`
📄 Parsing `hatch_project/requirements.yaml`
📄 Parsing `setup_py_project/requirements.yaml`
📄 Parsing include `../setuptools_project`
📄 Parsing `setuptools_project/requirements.yaml`
📝 Generating environment file at `environment.yaml`
📝 Environment file generated successfully.
✅ Generated environment file at `environment.yaml` from `hatch_project/requirements.yaml`, `setup_py_project/requirements.yaml`, `setuptools_project/requirements.yaml`
```

<!-- OUTPUT:END -->

See the resulting [`environment.yaml`](environment.yaml) file.

### Installing with `pip` from a `requirements.yaml` File

This method allows you to install packages defined in a `requirements.yaml` file using `pip`. It focuses on installing only those dependencies that are pip-installable, followed by the local project package.

**How to Use**:

- Run `pip install ./setup_py_project`.
- This command will process the `requirements.yaml` in the specified directory (`./setup_py_project/`), installing all pip-installable dependencies and then the local project itself.

### Installing with `unidep` from a `requirements.yaml` File

Using `unidep` for installation offers a more comprehensive approach. It handles both Conda and Pip dependencies specified in the `requirements.yaml` file, ensuring all necessary packages are installed, including those not available through pip.

**How to Use**:

- To perform a standard installation, run `unidep install ./setup_py_project`.
- For an editable installation (useful during development), use `unidep install -e ./setup_py_project`.
- The `unidep install` command first installs any Conda-specific dependencies from the `requirements.yaml` file, then proceeds to install pip-specific dependencies. Finally, it installs the local project package.

<!-- CODE:BASH:START -->
<!-- echo '```bash' -->
<!-- echo '$ unidep install --dry-run -e ./setup_py_project' -->
<!-- unidep install --dry-run -e ./setup_py_project -->
<!-- echo '```' -->
<!-- CODE:END -->
<!-- OUTPUT:START -->
<!-- ⚠️ This content is auto-generated by `markdown-code-runner`. -->
```bash
$ unidep install --dry-run -e ./setup_py_project
📦 Installing conda dependencies with `conda install --yes --override-channels --channel conda-forge pandas adaptive">=1.0.0, <2.0.0" pfapack pipefunc`

📦 Installing pip dependencies with `/opt/hostedtoolcache/Python/3.12.1/x64/bin/python -m pip install yaml2bib rsync-time-machine slurm-usage codestructure aiokef markdown-code-runner home-assistant-streamdeck-yaml`

📝 Found local dependencies: {'setup_py_project': ['hatch_project', 'setuptools_project']}

📦 Installing project with `/opt/hostedtoolcache/Python/3.12.1/x64/bin/python -m pip install --no-dependencies -e /home/runner/work/unidep/unidep/example/hatch_project -e /home/runner/work/unidep/unidep/example/setuptools_project -e ./setup_py_project`

```

<!-- OUTPUT:END -->
